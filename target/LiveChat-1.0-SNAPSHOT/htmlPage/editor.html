<!DOCTYPE html>
<!--
Author : echo0 
Email   : ech0.extreme@foxmail.com

-->
<!DOCTYPE HTML>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <title>利用 clipboardData 在网页中实现截屏粘贴的功能</title>
        <style type="text/css">
            #input{height:500px; border:1px solid #ddd; }
        </style>
        <script type="text/javascript" src="../js/jquery.min.js"></script>
    </head>
    <body>
            
        <h1>利用 clipboardData 在网页中实现截屏粘贴的功能</h1>   
        <hr />
        
        <!--to base64-->
        <div>
            <div id="input" contenteditable>

            </div>
            <script type="text/javascript">
                (function () {
                    var imgReader = function (item) {
                        var blob = item.getAsFile(),
                                reader = new FileReader();

                        reader.onload = function (e) {
                            var img = new Image();

                            img.src = e.target.result;
                            document.getElementById('input').appendChild(img);
                        };

                        reader.readAsDataURL(blob);
                    };
                    document.getElementById('input').addEventListener('paste', function (e) {
                        var clipboardData = e.clipboardData,
                                i = 0,
                                items, item, types;

                        if (clipboardData) {
                            items = clipboardData.items;

                            if (!items) {
                                return;
                            }

                            item = items[0];
                            types = clipboardData.types || [];

                            for (; i < types.length; i++) {
                                if (types[i] === 'Files') {
                                    item = items[i];
                                    break;
                                }
                            }

                            if (item && item.kind === 'file' && item.type.match(/^image\//i)) {
                                imgReader(item);
                            }
                        }
                    });
                })();
            </script>
    </body>
</html>

